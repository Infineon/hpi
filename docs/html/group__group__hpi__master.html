<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HPI Library</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen_style.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><a href="http://www.cypress.com/"><img alt="Logo" src="logo.png"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">HPI Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__group__hpi__master.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#groups">API Reference</a>  </div>
  <div class="headertitle">
<div class="title">HPIM (HPI Master)</div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">General Description</h2>
<p>The Host Processor Interface (HPI) master library implements a set of APIs through which the application communicates over the HPI interface to monitor or control the operating condition of other HPI slave devices. </p>
<p>The middleware implements an asynchronous interrupt-based event queue handling.</p>
<p>HPI master communicates over an I2C interface (supported clock frequencies are 1 MHz, 400 kHz, and 100 kHz) with an interrupt line using a GPIO.</p>
<p><b>Features:</b></p><ul>
<li>Firmware version identification</li>
<li>Firmware update capability</li>
<li>Enquiry of Type-C and USB PD connection status</li>
<li>Control of USB PD power profiles</li>
</ul>
<h1><a class="anchor" id="section_hpim_general_description"></a>
General description</h1>
<p>Includes cy_hpi_master_defines.h and cy_hpi_master.h to access all the functions and other declarations in this library. See the <a class="el" href="group__group__hpi__master.html#section_hpim_quick_start">Quick Start Guide</a> to use the HPI library.</p>
<p>See the <a class="el" href="index.html#section_toolchain">Supported software and tools</a> section for compatibility information.</p>
<p>See the <a class="el" href="index.html#section_changelog">Changelog</a> section for change history.</p>
<h1><a class="anchor" id="section_hpim_quick_start"></a>
Quick Start Guide</h1>
<p>HPI master middleware is used in ModusToolbox(TM) based development environment. See the <a class="el" href="index.html#section_toolchain">Supported software and tools</a> section.</p>
<p>These steps describe the simplest method to enable the HPI master middleware in an application.</p>
<ol type="1">
<li>Create or open an application to add HPI master functions.</li>
<li>Add the HPI master middleware to your project. This quick start guide assumes that the environment is configured to use the MTB CAT2 Peripheral Driver Library (PDL) for development and the PDL is included in the project.</li>
<li>Include cy_hpi_master.h and cy_hpi_master_defines.h to get access to all functions and other declarations in this library. <div class="fragment"><div class="line"><span class="preprocessor">#include &quot;cy_hpi_master.h&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;cy_hpi_master_defines.h&quot;</span></div></div><!-- fragment --></li>
<li>Define the following data structures required by the HPI master middleware:<ul>
<li>HPI master required buffers and data structures <div class="fragment"><div class="line"><span class="keyword">static</span> cy_stc_scb_i2c_context_t gl_hpimI2cContext;  <span class="comment">/* I2C master context */</span></div><div class="line"><span class="keyword">static</span> uint8_t gl_hpimResponseBuffer[0x40U];        <span class="comment">/* Buffer to handle slave response messages */</span></div><div class="line"><span class="keyword">static</span> <a class="code" href="structcy__hpi__master__slave__dev__t.html">cy_hpi_master_slave_dev_t</a> gl_hpimSlaveDevices[0x03U];    <span class="comment">/* HPI slave devices */</span></div><div class="line"><span class="keyword">static</span> uint8_t gl_hpimEvtQueueBuffer[0x200U];                   <span class="comment">/* Buffer to handle event queue */</span></div><div class="line"><span class="keyword">static</span> <a class="code" href="structcy__hpi__master__event__queue__t.html">cy_hpi_master_event_queue_t</a> gl_hpimEventQueue =          <span class="comment">/* Event Queue */</span></div><div class="line">{</div><div class="line">    .<a class="code" href="structcy__hpi__master__event__queue__t.html#acaa8daa910afd3000be175bba8ec0223">startAddress</a> = gl_hpimEvtQueueBuffer,          <span class="comment">/* Queue Buffer */</span></div><div class="line">    .bufferSize   = 0x200U,                         <span class="comment">/* Buffer Size in bytes */</span></div><div class="line">    .headIdx      = 0x00U,                          <span class="comment">/* Queue head index */</span></div><div class="line">    .tailIdx      = 0x00U                           <span class="comment">/* Queue tail index */</span></div><div class="line">};</div></div><!-- fragment --></li>
<li>HPI master context parameters <div class="fragment"><div class="line"><span class="keyword">static</span> <a class="code" href="structcy__hpi__master__context__t.html">cy_hpi_master_context_t</a> gl_hpimContext =</div><div class="line">{</div><div class="line">    .<a class="code" href="structcy__hpi__master__context__t.html#a4ab91008a57ed7f6ed66d7e8a2522c05">ptrEventQueue</a>   = &amp;gl_hpimEventQueue,          <span class="comment">/* Event Queue */</span></div><div class="line">    .maxSlaveDevices = 0x03U,                       <span class="comment">/* Supported slave devices max count*/</span></div><div class="line">    .ptrSlaves       = gl_hpimSlaveDevices,         <span class="comment">/* Pointer to slave device array*/</span></div><div class="line">    .ptrScbBase      = SCB0,                        <span class="comment">/* I2C SCB base address */</span></div><div class="line">    .ptrI2cContext   = &amp;gl_hpimI2cContext,          <span class="comment">/* I2C context */</span></div><div class="line">    .respBuffLen     = 0x40U,                       <span class="comment">/* Response buffer length in bytes */</span></div><div class="line">    .ptrRespBuff     = gl_hpimResponseBuffer,       <span class="comment">/* Pointer to response buffer */</span></div><div class="line">};</div></div><!-- fragment --></li>
<li>Register application callback functions <div class="fragment"><div class="line"><span class="keyword">static</span> <a class="code" href="structcy__hpi__master__app__cbk__t.html">cy_hpi_master_app_cbk_t</a> gl_hpimAppCallback =</div><div class="line">{</div><div class="line">    .<a class="code" href="structcy__hpi__master__app__cbk__t.html#a606671860be33e00236544688adb478b">i2c_master_read</a> = i2c_master_read,</div><div class="line">    .i2c_master_write = i2c_master_write,</div><div class="line">    .event_handler = hpi_master_event_handler,</div><div class="line">    .error_handler = hpi_master_error_handler</div><div class="line">};</div></div><!-- fragment --> The HPI master library uses these callbacks registered by the application to perform the application-specific tasks such as read/write on the I2C bus, handle slave events, handle error conditions, and so on.</li>
</ul>
</li>
<li>Initialize the HPI master middleware. Configure and initialize the I2C SCB before calling this function. <div class="fragment"><div class="line">    (void)<a class="code" href="group__group__hpim__functions.html#ga60e18016ce9bc554d1e88efaaed87d8b">Cy_HPI_Master_Init</a>(&amp;gl_hpimContext, &amp;gl_hpimAppCallback);</div></div><!-- fragment --></li>
<li><p class="startli">Register a slave device. The interrupt GPIO is already configured.</p>
<div class="fragment"><div class="line">    (void)<a class="code" href="group__group__hpim__functions.html#gafc1114484b8ed841da1aca2925e84afd">Cy_HPI_Master_SlaveDeviceInit</a>(&amp;gl_hpimContext, <span class="comment">/* Pointer to HPI master context */</span></div><div class="line">                                        0x08,            <span class="comment">/* Slave address (7-bit) */</span></div><div class="line">                                        2,               <span class="comment">/* Interrupt GPIO port number */</span></div><div class="line">                                        1,               <span class="comment">/* Interrupt GPIO pin number */</span></div><div class="line">                                        2);              <span class="comment">/* Supported port count */</span></div></div><!-- fragment --></li>
<li>Invoke the <a class="el" href="group__group__hpim__functions.html#ga9ba762661cd0914991523f04f13af0f4">Cy_HPI_Master_InterruptHandler</a> function from the GPIO interrupt service routine for each slave device. <div class="fragment"><div class="line">    (void)<a class="code" href="group__group__hpim__functions.html#ga9ba762661cd0914991523f04f13af0f4">Cy_HPI_Master_InterruptHandler</a>(&amp;gl_hpimContext,   <span class="comment">/* Pointer to HPI master context */</span></div><div class="line">                                         2,                 <span class="comment">/* Interrupt GPIO port number */</span></div><div class="line">                                         1);                <span class="comment">/* Interrupt GPIO pin number */</span></div></div><!-- fragment --></li>
<li>Call <a class="el" href="group__group__hpim__functions.html#gaade01607ef643a33e75b26f727f2e9ca">Cy_HPI_Master_Task</a> from the main processing loop of the application to handle the slave device events. <div class="fragment"><div class="line">    (void)<a class="code" href="group__group__hpim__functions.html#gaade01607ef643a33e75b26f727f2e9ca">Cy_HPI_Master_Task</a>(&amp;gl_hpimContext);</div></div><!-- fragment --></li>
</ol>
<h1><a class="anchor" id="section_hpim_configuration_considerations"></a>
Configuration considerations</h1>
<h1><a class="anchor" id="section_hpim_miscellaneous"></a>
Limitations and restrictions</h1>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="groups"></a>
API Reference</h2></td></tr>
<tr class="memitem:group__group__hpim__macros"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group__hpim__macros.html">Macros</a></td></tr>
<tr class="memdesc:group__group__hpim__macros"><td class="mdescLeft">&#160;</td><td class="mdescRight">Describes the HPI master macros. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group__group__hpim__functions"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group__hpim__functions.html">Functions</a></td></tr>
<tr class="memdesc:group__group__hpim__functions"><td class="mdescLeft">&#160;</td><td class="mdescRight">Describes the HPI master function prototypes. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group__group__hpim__data__structures"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group__hpim__data__structures.html">Data Structures</a></td></tr>
<tr class="memdesc:group__group__hpim__data__structures"><td class="mdescLeft">&#160;</td><td class="mdescRight">Describes the data structures defined by the HPI master. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group__group__hpim__enums"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group__hpim__enums.html">Enumerated types</a></td></tr>
<tr class="memdesc:group__group__hpim__enums"><td class="mdescLeft">&#160;</td><td class="mdescRight">Describes the enumeration types defined by the HPI master. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part
<div id="nav-path" class="navpath">
    <ul>
        <li class="footer">
            Generated for <b>HPI Library</b> by <b>Cypress Semiconductor Corporation</b>.
            All rights reserved.
        </li>
    </ul>
</div>
-->
</body>
</html>
